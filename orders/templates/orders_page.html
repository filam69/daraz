<!DOCTYPE html>
<html>
<head>
    <title>Order List</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../static/css/styles.css">
</head>
<body>

<div id="dropdownContainer">
    <button onclick="addDropdown()">Add Dropdown</button>
</div>

<script>
    function addDropdown() {
        // Create new dropdown container
        var newDropdownContainer = document.createElement("div");
        newDropdownContainer.classList.add("dropdown-container");

        // Create 'Single' dropdown
        var singleDropdown = document.createElement("select");
        singleDropdown.classList.add("single-dropdown");
        singleDropdown.name = "single_dropdown";

        // Create default option "Select"
        var defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.text = "Select";
        singleDropdown.appendChild(defaultOption);

        // Add options to 'Single' dropdown
        {% for order in orders %}
            var option = document.createElement("option");
            option.value = "{{ order.id }}";
            option.text = "{{ order.name }}";
            singleDropdown.appendChild(option);
        {% endfor %}
        
  
        // Event listener for 'Single' dropdown change
        singleDropdown.addEventListener('change', function() {
            var selectedOrderId = this.value;

            // Clear previous content in newDropdownContainer
            newDropdownContainer.innerHTML = '';

            if (selectedOrderId === "1" || selectedOrderId === "single") {
                // Generate for "single" or "1"
                for (var i = 1; i <= 2; i++) {
                    var attachmentButtonsContainer = document.createElement("div");

                    // Create attachment button
                    var attachmentButton = document.createElement("input");
                    attachmentButton.type = "file";
                    attachmentButton.name = "attachment" + i;
                    attachmentButtonsContainer.appendChild(attachmentButton);
                    attachmentButtonsContainer.appendChild(document.createElement("br")); // Add line break

                    // Create game dropdowns
                    for (var j = 1; j <= 4; j++) {
                        var gameDropdown = document.createElement("select");
                        gameDropdown.classList.add("game-dropdown");
                        gameDropdown.name = "game_dropdown_" + i + "_" + j;

                        // Create default option "Select"
                        var defaultGameOption = document.createElement("option");
                        defaultGameOption.value = "";
                        defaultGameOption.text = "Select";
                        gameDropdown.appendChild(defaultGameOption);

                        // Add options to game dropdown from games
                        {% for game in games %}
                            var option = document.createElement("option");
                            option.value = "{{ game.id }}";
                            option.text = "{{ game.name }}";
                            gameDropdown.appendChild(option);
                        {% endfor %}

                        attachmentButtonsContainer.appendChild(gameDropdown);
                    }

                    // Append attachment buttons and game dropdowns to container
                    newDropdownContainer.appendChild(attachmentButtonsContainer);
                    newDropdownContainer.appendChild(document.createElement("br")); // Add line break
                }
            } else if (selectedOrderId === "3") {
                // Generate for "3"
                var attachmentButtonsContainer = document.createElement("div");

                // Create attachment button
                var attachmentButton = document.createElement("input");
                attachmentButton.type = "file";
                attachmentButton.name = "attachment1";
                attachmentButtonsContainer.appendChild(attachmentButton);
                attachmentButtonsContainer.appendChild(document.createElement("br")); // Add line break

                // Create 12 game dropdowns
                for (var j = 1; j <= 12; j++) {
                    var gameDropdown = document.createElement("select");
                    gameDropdown.classList.add("game-dropdown");
                    gameDropdown.name = "game_dropdown_1_" + j;

                    // Create default option "Select"
                    var defaultGameOption = document.createElement("option");
                    defaultGameOption.value = "";
                    defaultGameOption.text = "Select";
                    gameDropdown.appendChild(defaultGameOption);

                    // Add options to game dropdown from games
                    {% for game in games %}
                        var option = document.createElement("option");
                        option.value = "{{ game.id }}";
                        option.text = "{{ game.name }}";
                        gameDropdown.appendChild(option);
                    {% endfor %}

                    attachmentButtonsContainer.appendChild(gameDropdown);
                }

                // Append attachment button and game dropdowns to container
                newDropdownContainer.appendChild(attachmentButtonsContainer);
                newDropdownContainer.appendChild(document.createElement("br")); // Add line break
            }

            // Create "Create File" button
            var createFileButton = document.createElement("button");
            createFileButton.textContent = "Create File";
            createFileButton.type = "button"; // Ensure it doesn't submit form
            createFileButton.addEventListener('click', function() {
                // Show which create file button was clicked
                alert("Button " + selectedOrderId + " is clicked.");
            });
            newDropdownContainer.appendChild(createFileButton);
        });

        // Append 'Single' dropdown to new dropdown container
        newDropdownContainer.appendChild(singleDropdown);

        // Append new dropdown container to main container
        document.getElementById("dropdownContainer").appendChild(newDropdownContainer);
    }
</script>

</body>
</html>